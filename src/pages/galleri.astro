---
import Header from "../components/header.astro";
import Footer from "../components/footer.astro";
import Layout from "../layouts/Layout.astro";
import ImgTekstGalleri from "../components/ImgTekstGalleri.astro";

const url =
  "https://bthhfklfetpicuolnkyp.supabase.co/rest/v1/produkter?select=*";
const key =
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ0aGhma2xmZXRwaWN1b2xua3lwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc2NTA5MDMsImV4cCI6MjA2MzIyNjkwM30.oCFLXDzG2ItPy4MqhDi5d5nG3EixOPRD-pLPqPKubC4";

const option = {
  headers: {
    apikey: key,
  },
};

const data = await fetch(url, option).then((res) => {
  return res.json();
});

console.log(data);
---

<Layout>
  <Header />
  <main>
    <!-- HERO -->
    <section class="galleri_hero bg_lamper">
      <span class="galleri_tekst">galleri</span>
      <span class="unika_tekst">unika</span>
    </section>

    <!-- GALLERI -->
    <div class="grid">
      <div class="felt1">
        <!-- Bruger komponenten ImgTekstGalleri og giver den et billede + tekst -->
        <ImgTekstGalleri
          src="/src/assets/lokal_kontakt.webp"
          alt="billede af lokals lokale"
        />
      </div>

      <div class="felt2_tekst">
        her får du et kig ind i vores skiftende udvalg. alle varer er unika og
        kan kun købes i butikken – kig forbi og oplev det hele selv.
      </div>

      <div class="felt2">
        <a href={`/produkter/${data[0].product_slug}`}>
          <ImgTekstGalleri
            src={`/galleri_imgs/${data[0].image}`}
            alt={data[0].product_name}
            title={data[0].product_name}
            price={data[0].price}
            class="galleri_hover"
            class="galleri_hover felt2_title"
          />
        </a>
      </div>
      <div class="felt3">
        <!-- Bruger komponenten ImgTekstGalleri og giver den et billede + tekst -->
        <a href={`/produkter/${data[1].product_slug}`}>
          <ImgTekstGalleri
            src={`/galleri_imgs/${data[1].image}`}
            alt={data[1].product_name}
            title={data[1].product_name}
            class="galleri_hover"
            price={data[1].price}
          />
        </a>
      </div>

      <!-- SROLLBAR -->

      <div class="felt4">
        <span class="scroll-title">Scroll</span>
        <div class="scroll_produkt">
          <a href={`/produkter/${data[2].product_slug}`}>
            <img
              src={`/galleri_imgs/${data[2].image}`}
              alt={data[2].product_name}
            />
          </a>
        </div>
        <div class="scroll_produkt">
          <a href={`/produkter/${data[2].product_slug}`}>
            <img
              src={`/galleri_imgs/${data[2].image}`}
              alt={data[2].product_name}
            />
          </a>
        </div>
        <div class="scroll_produkt">
          <a href={`/produkter/${data[2].product_slug}`}>
            <img
              src={`/galleri_imgs/${data[2].image}`}
              alt={data[2].product_name}
            />
          </a>
        </div>
        <div class="scroll_produkt">
          <a href={`/produkter/${data[2].product_slug}`}>
            <img
              src={`/galleri_imgs/${data[2].image}`}
              alt={data[2].product_name}
            />
          </a>
        </div>
        <div class="scroll_produkt">
          <a href={`/produkter/${data[2].product_slug}`}>
            <img
              src={`/galleri_imgs/${data[2].image}`}
              alt={data[2].product_name}
            />
          </a>
        </div>
      </div>

      <!-- Grid med 2 kolonner: 1 del og 2 dele -->
      <div class="img_grid2">
        <div class="felt5">
          <!-- Bruger komponenten ImgTekstGalleri og giver den et billede + tekst -->
          <a href={`/produkter/${data[7].product_slug}`}>
            <ImgTekstGalleri
              src={`/galleri_imgs/${data[7].image}`}
              alt={data[7].product_name}
              title={data[7].product_name}
              price={data[7].price}
              class="galleri_hover"
            />
          </a>
        </div>
        <div class="felt6">
          <!-- Bruger komponenten ImgTekstGalleri og giver den et billede + tekst -->
          <a href={`/produkter/${data[3].product_slug}`}>
            <ImgTekstGalleri
              src={`/galleri_imgs/${data[3].image}`}
              alt={data[3].product_name}
              title={data[3].product_name}
              price={data[3].price}
              class="galleri_hover"
            />
          </a>
        </div>
      </div>

      <div class="felt7">
        <!-- Bruger komponenten ImgTekstGalleri og giver den et billede + tekst -->
        <a href={`/produkter/${data[4].product_slug}`}>
          <ImgTekstGalleri
            src={`/galleri_imgs/${data[4].image}`}
            alt={data[4].product_name}
            title={data[4].product_name}
            price={data[4].price}
            class="galleri_hover"
          />
        </a>
      </div>
      <div class="felt8">
        <!-- Bruger komponenten ImgTekstGalleri og giver den et billede + tekst -->
        <a href={`/produkter/${data[5].product_slug}`}>
          <ImgTekstGalleri
            src={`/galleri_imgs/${data[5].image}`}
            alt={data[5].product_name}
            title={data[5].product_name}
            price={data[5].price}
            class="galleri_hover"
          />
        </a>
      </div>

      <div class="felt9">
        <!-- Bruger komponenten ImgTekstGalleri og giver den et billede + tekst -->
        <ImgTekstGalleri
          src="/src/assets/lokal_galleri.webp"
          alt="kaffe og diverse på et bord på lokal"
        />
      </div>
      <div class="felt10">
        <!-- Bruger komponenten ImgTekstGalleri og giver den et billede + tekst -->
        <a href={`/produkter/${data[6].product_slug}`}>
          <ImgTekstGalleri
            src={`/galleri_imgs/${data[6].image}`}
            alt={data[6].product_name}
            title={data[6].product_name}
            price={data[6].price}
            class="galleri_hover"
          />
        </a>
      </div>
    </div>
  </main>

  <Footer />

  <style>
    /* :global() gør, at reglen ikke bliver scoppet til kun denne side, men gælder for alle billeder med klassen galleri_hover – også dem, der kommer fra komponenter. */
    :global(img.galleri_hover:hover) {
      transform: scale(1.05);
      transition: transform 0.3s ease;
    }

    .galleri_hero {
      display: flex;
      /* så 'os' følger 'kontakt' nederst */
      align-items: baseline;
      gap: 0.2rem;
      margin-bottom: 2rem;
      padding-top: clamp(8rem, 22vw, 25rem);
      padding-left: 1rem;
    }
    .bg_lamper {
      background-image: url("/src/assets/kontakt_lamper.webp");
      background-position: top -8px right 1px;
      background-repeat: no-repeat;
      background-size: 70%;
    }
    .galleri_tekst {
      font-family: "Futura", sans-serif;
      color: var(--accent);
      font-size: clamp(4.9rem, 20vw, 22rem);
      font-weight: 700;
      line-height: 1;
      margin: 0;
      padding-top: 3.5rem;
    }
    .unika_tekst {
      font-family: "Gabriela", serif;
      font-size: 1.4rem;
      color: var(--accent);
      writing-mode: vertical-rl;
      transform: rotate(180deg);
      margin-bottom: 0.5rem;
      margin-left: -0.5rem;
      z-index: 1;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-auto-rows: auto; /* automatisk tilpasser højden på rækkerne */
      padding-bottom: 3rem;
    }
    /*sikrer at billederne fylder hele feltet og ikke forvrænges*/
    .grid img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* beskærer billedet hvis det ikke passer i størrelsesforholdet */
      display: block;
    }

    .grid img:hover {
      transform: scale(1.05);
      transition: transform 0.3s ease;
    }

    .felt1 {
      border-top: 2px solid black;
      grid-column: 1 / -1; /*feltet fylder hele bredden af gridet*/
      border-bottom: 2px solid black;
    }
    .felt2 {
      grid-row: 3 / 4;
      border-top: 2px solid black;
      border-bottom: 2px solid black;
    }

    :global(.felt2 .felt2_title ~ .image-title),
    :global(.felt2 .felt2_title .image-title) {
      /* fallback hvis .image-title ligger som child */
      display: inline;
    }

    .felt2_tekst {
      font-family: "Futura", sans-serif;
      font-size: clamp(0.8rem, 3.7vw, 1.2rem);
      padding: 10px;
      color: var(--black);
      grid-column: 1 / span 2; /*feltet fylder hele bredden af gridet*/
      grid-row: 2;
      padding-top: 2rem;
      padding-bottom: 2rem;
    }
    .felt3 {
      border-top: 2px solid black;
      grid-column: 2 / 3; /* placerer feltet i første kolonne */
      border-bottom: 2px solid black;
    }

    /* FELTET MED SCROLL */
    .felt4 {
      overflow-x: auto; /* gør det muligt at scrolle vandret */
      grid-row: 4 / span 1; /* placerer feltet i anden række */
      grid-column: 1 / span 2; /*feltet fylder hele bredden af gridet*/
      display: flex;
      background-image: url("/src/assets/arrow_right.svg");
      background-repeat: no-repeat;
      background-position: right 10px bottom 10px;
      background-size: clamp(2rem, 2vw, 3rem);
      font-size: clamp(0.8rem, 2vw, 1.2rem);
      border-bottom: solid black 2px;
    }

    /* TITLEN PÅ SCROLLBILLED */
    .scroll-title {
      position: sticky; /* gør det muligt at placere teksten (scroll-title) absolut i forhold til denne wrapper */
      top: 4px; /* placerer teksten 8px fra toppen */
      left: 8px; /* placerer teksten 8px fra venstre */
      padding: 10px 8px;
      font-size: 0.75rem;
      font-family: "Futura", sans-serif;
      z-index: 20; /* sikrer at teksten er ovenpå billedet */
    }

    /* SCROLLBILLED */
    .scroll_produkt {
      min-width: 40%; /* sikre at man kan se flere billeder på en gang: flere billeder i viewpointen */
      margin-bottom: 30px;
    }
    /*række med 2 kolonner: 1 del og 2 dele*/
    .img_grid2 {
      display: grid;
      grid-template-columns: 1fr 2fr; /*deler gridet op i en smal og bred kolonne*/
      grid-column: 1 / -1; /*feltet fylder hele bredden af gridet*/
    }
    .felt5 {
      grid-column: 1; /*placerer feltet i den første kolonne*/
      border-right: 2px solid black;
      border-bottom: 2px solid black;
    }

    .felt6 {
      grid-column: 2; /*placerer feltet i den anden kolonne*/
      border-bottom: 2px solid black;
    }

    .felt9 {
      border-right: 2px solid black;
      border-top: 2px solid black;
      border-bottom: 2px solid black;
    }

    .felt10 {
      border-top: 2px solid black;
      border-bottom: 2px solid black;
    }

    @media (min-width: 800px) {
      .bg_lamper {
        background-position: top -70px right 10px;
        background-size: 50%;
      }
      .galleri_hero {
        padding-left: 2rem;
      }
      .galleri_tekst {
        font-size: 18.75rem;
        padding-bottom: 2rem;
      }
      .unika_tekst {
        font-size: 5.6rem;
      }

      .grid {
        grid-template-columns: repeat(12, 1fr); /* 3 kolonner i stedet for 2 */
        grid-auto-rows: 500px;
        border-top: 2px solid black;
        padding-bottom: 6rem;
      }

      .felt1 {
        grid-column: 7 / span 6;
        grid-row: 1 / 2;
        border: none;
      }

      .felt2 {
        grid-column: 3 / span 4;
        grid-row: 1 / 2;
        border-bottom: none;
        border-right: 2px solid black;
        border-top: none;
      }

      :global(.felt2 .image-title) {
        display: none;
      }

      .felt2_tekst {
        grid-column: 1 / span 6;
        grid-row: 1 / 2;
        font-family: "Futura", sans-serif;
        font-size: 1.49rem;
        padding: 20px;
        color: var(--black);
      }

      .felt3 {
        grid-column: 1 / span 4;
        grid-row: 2;
        border-right: solid 2px black;
        border-top: 2px solid black;
        border-bottom: none;
      }
      .img_grid2 {
        grid-template-columns: 1fr 1fr;
        grid-auto-rows: 500px;
        grid-column: 5 / span 8; /* feltet fylder hele bredden af gridet */
        grid-row: 2;
        border-top: 2px solid black;
      }
      .scroll_produkt img {
        width: 90%;
        height: 90%;
      }
      .scroll_produkt {
        min-width: 25%;
      } /*sikre */

      .felt4 {
        padding: 0;
        margin: 0;
        align-items: center;
        overflow-x: auto;
        grid-column: 1 / -1; /* sikrer den fylder hele bredden af grid */
        grid-row: 3 / 4;
        width: 100%;
        box-sizing: border-box;
        display: flex; /* gør det til en vandret scroller */
        background-position: right 20px bottom 20px;
        border-top: 2px solid black;
      }

      .scroll-title {
        margin-top: 1rem;
        align-self: flex-start;
        font-size: 1rem;
      }

      /* felt 5 og 6 ligger i en grid, og følger derfor ikke det store grid med 12 kolonner. Den har istedet 2 kolonner, og spanner og fylder 1 kolonne hver i eget grid.*/
      .felt5 {
        grid-column: 2;
        grid-row: 1 / 2;
        border-right: none;
      }

      .felt6 {
        grid-column: 1;
        grid-row: 1 / 2;
        border-right: 2px solid black;
      }

      .felt7 {
        grid-column: 1 / span 3;
        grid-row: 4;
        border-bottom: 2px solid black;
      }
      .felt8 {
        grid-column: 4 / span 3;
        grid-row: 4;
        border-bottom: 2px solid black;
      }
      .felt9 {
        grid-column: 10 / span 3;
        grid-row: 4;
        border-left: 2px solid black;
        border-top: none;
      }
      .felt10 {
        grid-column: 7 / span 3;
        grid-row: 4;
        border-top: none;
        border-left: 2px solid black;
      }
    }
  </style>
</Layout>
